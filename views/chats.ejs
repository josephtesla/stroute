<%- include('templates/header') %>

		<div class="content-app">
			<div class="row" id="messageArea">
				<div class="col-md-4" id="online">
					<div class="well">
           
            <div class="card">
              <div class="card-body"  id="users">
              </div>
            </div>
					</div>
				</div>
				<div class="col-md-8">
				
				</div>
			</div>
    </div>
    </div>
		<div class="content-app">
			<div class="row" id="messageArea">
				<div class="col-md-12" id="online">
					<br>
					<div class="mesgs">
						<div class="msg_history">
              <div class="msg_hist">
							<div class="incoming_msg">
								<div class="incoming_msg_img"> <img src="https://ptetutorials.com/images/user-profile.png" alt="sunil"> </div>
								<div class="received_msg">
									<div class="received_withd_msg">
										<p>End-to-end user encryption now enabled. chats cannot be viewed by a third party</p>
										<span class="time_date"> 11:01 AM | Dec 11</span>
									</div>
								</div>
							</div>
							
						<% chats.forEach(function(chat){	%>
							<%  if (chat.message.type !== "text") {	%>
							<% if (chat.sender === user.username){  %>
							<div class="outgoing_msg">
								<div class="sent_msg">
										<span class="imgwhite ">
										<%  if (chat.message.type === "image") {	%>
										<img class="bg-white" style="border:3px solid white"	src="<%= chat.message.msg %>"	 width="100%"/>
										<%	}   %>

										<%  if (chat.message.type === "audio") {	%>
											<span class="imgwhite "><audio	class="bg-white" controls>
												<source src="http://localhost:5000/<%= chat.message.msg %>" 
													type="audio/mp3">
												</source>
												<source src="http://localhost:5000/<%= chat.message.msg %>" 
													type="audio/ogg">
												</source>
												<source src="http://localhost:5000/<%= chat.message.msg %>" 
													type="audio/aac">
												</source>
											</audio> </span>
										<%	}   %>
										<%  if (chat.message.type === "video") {	%>
											<span class="imgwhite "><video class="bg-white"	width="100%"	height="100%"	controls>
												<source src="http://localhost:5000/<%= chat.message.msg %>" 
													type="video/mp4">
												</source>
												<source src="http://localhost:5000/<%= chat.message.msg %>" 
													type="video/ogg">
												</source>
												<source src="http://localhost:5000/<%= chat.message.msg %>" 
													type="video/aac">
												</source>
											</video> </span>
										<%	}   %>

										
									<span class="time_date">
										<%= chat.date %></span>
										</span>
										<%  if (chat.message.type === "text") {	%>
											<p><%= chat.message.msg %></p>
										<%	}   %>
								</div>
							</div>

							<%	}   %>
							<%	  if (chat.sender !== user.username){ %>
							<div class="incoming_msg">
								<div class="incoming_msg_img"> <img id="imgavatar" src="img/user.svg" alt="sunil"> </div>
								<div class="received_msg">
									<div class="received_withd_msg">
                    
												<%  if (chat.message.type === "image") {	%>
												<span class="imgwhite"><img style="border:3px solid white;"	src="<%= chat.message.msg %>" /></span>
												<%	}   %></span>

												<%  if (chat.message.type === "audio") {	%>
													<audio controls>
														<source src="http://localhost:5000/<%= chat.message.msg %>" 
															type="audio/mp3"></source>
															<source src="http://localhost:5000/<%= chat.message.msg %>" 
																type="audio/ogg">
															</source>
															<source src="http://localhost:5000/<%= chat.message.msg %>" 
																type="audio/aac">
															</source>
													</audio> 
												<%	}   %>

												<%  if (chat.message.type === "video") {	%>
													<span class="imgwhite"><video width="100%" style="border:3px solid white"	height="100%"	controls>
														<source src="http://localhost:5000/<%= chat.message.msg %>" 
															type="video/mp4">
														</source>
														<source src="http://localhost:5000/<%= chat.message.msg %>" 
															type="video/ogg">
														</source>
														<source src="http://localhost:5000/<%= chat.message.msg %>" 
															type="video/aac">
														</source>
													</video></span>
												<%	}   %>
										<span class="time_date">
											<a style="color:#f2dede;"	href="/users/<%=	chat.sender	%>"><%=	chat.sender.toUpperCase()	%></a> |
											<%=	chat.date	%></span>
									</div>
								</div>
							</div>
								<%	}   %>
							<%	}   %>
							<%  if (chat.message.type === "text") {	%>
								<%	  if (chat.sender !== user.username){ %>
									<div class="incoming_msg">
											<div class="incoming_msg_img"> <img id="imgavatar" src="img/user.svg" alt="img"> </div>
											<div class="received_msg">
												<div class="received_withd_msg">
													<p><%= chat.message.msg %></p>
													<span class="time_date"><a style="color:#f2dede;"	href="/users/<%=	chat.sender	%>"><%=	chat.sender.toUpperCase()	%></a> |
														<%=	chat.date	%></span>
												</div>
											</div>
										</div>

								<% }  %>
								<%	  if (chat.sender === user.username){ %>

									<div class="outgoing_msg">
											<div class="sent_msg">
														<p><%= chat.message.msg %></p>
														<span class="time_date"> |
																<%=	chat.date	%></span>
											</div>
									</div>
								<% }  %>
							<%	}   %>
            <%	})   %>
              <div	id="last"></div>
            </div>
            <div id='loader' class="outgoing_msg">
                <div class="sent_msg">
                  <div class='loader'>
                    <svg class='circular' viewBox='25 25 50 50'>
                        <circle class='path' cx='50' cy='50' r='20' fill='none' stroke-width='2' stroke-miterlimit='10'></circle>
                    </svg>
                </div>
                </div>
              </div>
						</div>
						<div class="type_msg">
							<div class="input_msg_write">
								<textarea id="message" type="text" class="write_msg" placeholder="Type a message"></textarea>
								<button id="btn" class="msg_send_btn" type="button"><i class="fa fa-send" aria-hidden="true"></i></button>
							</div>
							<br><a  class="btn btn-outline-primary btn-sm" href="" id="addlink">add link</a>
							<div id="link-form">
								<input id="linktext" placeholder="text to display" /><input id="link" placeholder="link" />
								<input type="button" id="linkbtn" value="add link" />
							</div>
							<a href="" class="btn btn-outline-primary btn-sm"	id="imgLink">send photo</a>
							<div id="img-form">
								<input type="file" id="image-upload" required name="image" placeholder="upload" />supports Jpg/png format
								<button id="btnImageSend">send</button>
              </div>
							<a	class="btn btn-outline-primary btn-sm" href="" id="mpLink">send audio/video</a>
							<div id="mp-form">
								<input type="file" name="mpsome" id="mp-upload"	required placeholder="upload only mp3/mp4/" />
								supports mp3/mp4 formats
								<select id="mpselect" name="mpsome">
									<option value="audio">Audio</option>
									<option value="video">Video</option>
								</select>
								<button id="btnMpSend">send</button>
              </div>
						</div>
					</div>
				</div>
			</div>
		</div>



		<footer>
			&copy	expressGo
		</footer>




	<script src="vendor/jquery/jquery.min.js"></script>
  <script src="js/socket.io.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
  <script src="js/upload.js"></script>
	<script src="vendor/popper.js/umd/popper.min.js"> </script>
	<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
	<script src="vendor/jquery.cookie/jquery.cookie.js"> </script>
	<script src="vendor/@fancyapps/fancybox/jquery.fancybox.min.js"></script>
	<script src="js/front.js"></script>
	<script src="js/code.js"></script>

	<!-- MDB core JavaScript -->
	<script type="text/javascript" src="md/js/mdb.min.js"></script>
	<!-- Initializations -->
	<script type="text/javascript">
		// Animations initialization
		new WOW().init();
	</script>

</body>



</html>